geom_text(x=cos(atan(r_object$coef[1]))*(R.IVW+Label.Scaling*1.5), y=sin(atan(r_object$coef[1]))*(R.IVW+Label.Scaling*1.5),
label=round(r_object$coef[1],digits=3),size=4)+
geom_text(x=cos(atan(r_object$confint[1])-0.02)*(R.IVW+Label.Scaling),y=sin(atan(r_object$confint[1])-0.02)*(R.IVW+Label.Scaling)-c(quantile(r_object$data$Wj,seq(0,0.1,0.1))[1]),
label=round(r_object$confint[1],digits=3),size=3)+
geom_text(x=cos(atan(r_object$confint[2])+0.02)*(R.IVW+Label.Scaling),y=sin(atan(r_object$confint[2])+0.02)*(R.IVW+Label.Scaling)+c(quantile(r_object$data$Wj,seq(0,0.1,0.1))[1]),
label=round(r_object$confint[2],digits=3),size=3)+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(beta)[j]~sqrt(W[j])))+xlab(expression(sqrt(W[j])))+
geom_segment(aes(x = 0, xend = cos(atan(r_object$coef[1]))*R.IVW, y = 0, yend = sin(atan(r_object$coef[1]))*R.IVW,colour="IVW"))+
scale_x_continuous(limits = c(0,R.IVW+(Label.Scaling*5)+c(quantile(r_object$data$Wj,seq(0,0.1,0.1))[1])),expand=c(0,0))+scale_y_continuous(limits = c(Y_MINIVW,Y_MAXIVW))+
coord_fixed()+scale_color_manual(name="Estimate",breaks=c("Variant","IVW"),values=c("IVW"="#56B4E9","Variant"="#000000"))
library(ggplot2)
x<-1:6
y<- x + rnorm(6,0,1)
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_smooth(method = "lm", se = FALSE,color = "black")+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() +
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+
geom_segment(aes(x = 0, xend = max(x)))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() +
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+
geom_segment(aes(x = 0, xend = max(x)),y=0,yend=max(y))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_smooth(method = "lm", se = FALSE,color = "black")+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))
plot
x<-1:6
y<- x + rnorm(6,0,1)
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_smooth(method = "lm", se = FALSE,color = "black")+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_smooth(method = "lm", se = FALSE,color = "black")+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()
plot
lm.model<-lm(y~-1 + x)
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_abline(intercept=0, slope=lm.model$coefficients[1], color='#2C3E50', size=1.1)
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_abline(intercept=0, slope=lm.model$coefficients[1], color='#2C3E50', size=1.1)
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_abline(intercept=0, slope=lm.model$coefficients[1], color='#2C3E50', size=1.1)
scale_x_continuous(limits = c(0,8),expand=c(0,0))
plot
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_abline(intercept=0, slope=lm.model$coefficients[1], color='#2C3E50', size=1.1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()
plot
lm.model<-lm(y~-1 + x)
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_abline(intercept=0, slope=lm.model$coefficients[1], color='#2C3E50', size=0.5)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()
plot
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_abline(intercept=0, slope=lm.model$coefficients[1], color='#2C3E50', size=1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()
plot
lm.model<-lm(y~-1 + x)
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1])+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()
plot
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + theme_bw() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]))+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]))+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j])+xlab(expression(hat(gamma)[j])
)
)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]))+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))
plot
lm.model<-lm(y~-1 + x)
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue")+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue",size=1.5)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))
plot
data<-data.frame(x,y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue",size=1.1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))
plot
se.x<-rnorm(6,0.5,0.02)
se.y<-rnorm(6,0.5,0.02)
data<-data.frame(x,y,se.x,se.y)
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue",size=1.1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))+
geom_errorbarh(aes(xmax = x + se.x, xmin = x - se.x))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue",size=1.1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))+
geom_errorbarh(aes(xmax = x + se.x, xmin = x - se.x))+geom_errorbarv(aes(ymax = y + se.y, ymin = y - se.y))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue",size=1.1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))+
geom_errorbarh(aes(xmax = x + se.x, xmin = x - se.x))+geom_pointrange(aes(ymin=y-y.se, ymax=y+y+y.se))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue",size=1.1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))+
geom_errorbarh(aes(xmax = x + se.x, xmin = x - se.x))+geom_pointrange(aes(ymin=y-se.y, ymax=y+y+se.y))
plot
se.y<-rnorm(6,0.5,0.02)
y-se.y
y+y+se.y
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue",size=1.1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,6),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))+
geom_errorbarh(aes(xmax = x + se.x, xmin = x - se.x)) + geom_pointrange(aes(ymin=y-se.y, ymax=y+se.y))
plot
plot<-ggplot(data, aes(x=x, y=y)) + geom_point() + geom_segment(aes(x = 0, xend = max(x), y = 0, yend = max(x) * lm.model$coefficients[1]),color="blue",size=1.1)+
scale_x_continuous(limits = c(0,8),expand=c(0,0))+scale_y_continuous(limits = c(0,8),expand=c(0,0))+coord_fixed()+
theme_bw()+theme(panel.border = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))+ylab(expression(hat(Gamma)[j]))+xlab(expression(hat(gamma)[j]))+
geom_errorbarh(aes(xmax = x + se.x, xmin = x - se.x)) + geom_pointrange(aes(ymin=y-se.y, ymax=y+se.y))
plot
jpeg("IVW1.jpg", width = 350, height = "350",res=300)
plot
dev.off()
jpeg("IVW1.jpg", width = 350, height = "350")
plot
dev.off()
png("IVW1.jpg", width = 8, height = 8, units = "in")
plot
dev.off()
png("IVW1.jpg", width = 8, height = 8, units = "in",res=300)
plot
dev.off()
png("IVW1.jpg", width = 5, height = 5, units = "in",res=300)
plot
dev.off()
library(RadialMR)
for_dat<-format_radial(x,y,se.x,se.y)
ivw.r<-ivw_radial(for_dat)
egger.r<-egger_radial(for_dat)
plot.r<-plot_radial(c(ivw.r,egger.r))
plot.r
plot.r<-plot_radial(c(ivw.r,egger.r),T,T,T)
plot.r
plot.r<-plot_radial(c(ivw.r,egger.r),F,F,F)
plot.r
png("Radial.jpg", width = 5, height = 5, units = "in",res=300)
plot.r
dev.off()
library(MVMR)
?format_mvmr
library(MVMR)
N<-100000
G<-rnorm(N,0,1)
X1<-1 + 1*G + rnorm(N,0,1)
X2<-1 + 1*G + rnorm(N,0,1)
Y<-1 + X1*0.5 + X2*0.7 + rnorm(N,0,1)
library(MVMR)
N<-100000
G1<-rnorm(N,0,1)
G2<-rnorm(N,0,1)
G3<-rnorm(N,0,1)
X1<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
X2<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
Y<-1 + X1*0.5 + X2*0.7 + rnorm(N,0,1)
BXG1<-lm(Y~G1)$coefficients[2]
lm(Y~G1)$coefficients
library(MVMR)
N<-100000
G1<-rnorm(N,0,1)
G2<-rnorm(N,0,1)
G3<-rnorm(N,0,1)
X1<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
X2<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
Y<-1 + X1*0.5 + X2*0.7 + rnorm(N,0,1)
BX1G1<-lm(X1~G1)$coefficients[2]
BX1G2<-lm(X1~G2)$coefficients[2]
BX1G3<-lm(X1~G3)$coefficients[2]
BX2G1<-lm(X2~G1)$coefficients[2]
BX2G2<-lm(X2~G2)$coefficients[2]
BX2G3<-lm(X2~G3)$coefficients[2]
library(MVMR)
N<-100000
G1<-rnorm(N,0,1)
G2<-rnorm(N,0,1)
G3<-rnorm(N,0,1)
X1<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
X2<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
Y<-1 + X1*0.5 + X2*0.7 + rnorm(N,0,1)
BX1G1<-lm(X1~G1)$coefficients[2]
BX1G2<-lm(X1~G2)$coefficients[2]
BX1G3<-lm(X1~G3)$coefficients[2]
BX2G1<-lm(X2~G1)$coefficients[2]
BX2G2<-lm(X2~G2)$coefficients[2]
BX2G3<-lm(X2~G3)$coefficients[2]
BYG1<-lm(Y~G1)$coefficients[2]
BYG2<-lm(Y~G2)$coefficients[2]
BYG3<-lm(Y~G3)$coefficients[2]
str(lm(X1~G1))
lm(Y~G1)$coefficients
summary(lm(X1~G1))
summary(lm(X1~G1))$coefficients
summary(lm(X1~G1))$coefficients
BX1G1<-summary(lm(X1~G1))$coefficients[2]
library(MVMR)
N<-100000
G1<-rnorm(N,0,1)
G2<-rnorm(N,0,1)
G3<-rnorm(N,0,1)
X1<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
X2<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
Y<-1 + X1*0.5 + X2*0.7 + rnorm(N,0,1)
summary(lm(X1~G1))$coefficients[2]
summary(lm(X1~G1))$coefficients[2,1]
summary(lm(X1~G1))$coefficients
summary(lm(X1~G1))$coefficients[2,2]
library(MVMR)
N<-100000
G1<-rnorm(N,0,1)
G2<-rnorm(N,0,1)
G3<-rnorm(N,0,1)
X1<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
X2<-1 + 1*G1 + 1*G2 + 1*G3 + rnorm(N,0,1)
Y<-1 + X1*0.5 + X2*0.7 + rnorm(N,0,1)
BX1G1<-summary(lm(X1~G1))$coefficients[2,1]
BX1G2<-summary(lm(X1~G2))$coefficients[2,1]
BX1G3<-summary(lm(X1~G3))$coefficients[2,1]
seBX1G1<-summary(lm(X1~G1))$coefficients[2,2]
seBX1G2<-summary(lm(X1~G2))$coefficients[2,2]
seBX1G3<-summary(lm(X1~G3))$coefficients[2,2]
BX2G1<-summary(lm(X2~G1))$coefficients[2]
BX2G2<-summary(lm(X2~G1))$coefficients[2]
BX2G3<-summary(lm(X2~G1))$coefficients[2]
seBX2G1<-summary(lm(X2~G1))$coefficients[2,2]
seBX2G2<-summary(lm(X2~G2))$coefficients[2,2]
seBX2G3<-summary(lm(X2~G3))$coefficients[2,2]
BYG1<-summary(lm(Y~G1))$coefficients[2,1]
BYG2<-summary(lm(Y~G1))$coefficients[2,1]
BYG3<-summary(lm(Y~G1))$coefficients[2,1]
seBYG1<-summary(lm(Y~G1))$coefficients[2,2]
seBYG2<-summary(lm(Y~G1))$coefficients[2,2]
seBYG3<-summary(lm(Y~G1))$coefficients[2,2]
BX1G1<-summary(lm(X1~G1))$coefficients[2,1]
BX1G2<-summary(lm(X1~G2))$coefficients[2,1]
BX1G3<-summary(lm(X1~G3))$coefficients[2,1]
seBX1G1<-summary(lm(X1~G1))$coefficients[2,2]
seBX1G2<-summary(lm(X1~G2))$coefficients[2,2]
seBX1G3<-summary(lm(X1~G3))$coefficients[2,2]
BX2G1<-summary(lm(X2~G1))$coefficients[2]
BX2G2<-summary(lm(X2~G1))$coefficients[2]
BX2G3<-summary(lm(X2~G1))$coefficients[2]
seBX2G1<-summary(lm(X2~G1))$coefficients[2,2]
seBX2G2<-summary(lm(X2~G2))$coefficients[2,2]
seBX2G3<-summary(lm(X2~G3))$coefficients[2,2]
BYG1<-summary(lm(Y~G1))$coefficients[2,1]
BYG2<-summary(lm(Y~G2))$coefficients[2,1]
BYG3<-summary(lm(Y~G3))$coefficients[2,1]
seBYG1<-summary(lm(Y~G1))$coefficients[2,2]
seBYG2<-summary(lm(Y~G2))$coefficients[2,2]
seBYG3<-summary(lm(Y~G3))$coefficients[2,2]
BX1G1<-summary(lm(X1~G1))$coefficients[2,1]
BX1G2<-summary(lm(X1~G2))$coefficients[2,1]
BX1G3<-summary(lm(X1~G3))$coefficients[2,1]
seBX1G1<-summary(lm(X1~G1))$coefficients[2,2]
seBX1G2<-summary(lm(X1~G2))$coefficients[2,2]
seBX1G3<-summary(lm(X1~G3))$coefficients[2,2]
BX2G1<-summary(lm(X2~G1))$coefficients[2]
BX2G2<-summary(lm(X2~G2))$coefficients[2]
BX2G3<-summary(lm(X2~G3))$coefficients[2]
seBX2G1<-summary(lm(X2~G1))$coefficients[2,2]
seBX2G2<-summary(lm(X2~G2))$coefficients[2,2]
seBX2G3<-summary(lm(X2~G3))$coefficients[2,2]
BYG1<-summary(lm(Y~G1))$coefficients[2,1]
BYG2<-summary(lm(Y~G2))$coefficients[2,1]
BYG3<-summary(lm(Y~G3))$coefficients[2,1]
seBYG1<-summary(lm(Y~G1))$coefficients[2,2]
seBYG2<-summary(lm(Y~G2))$coefficients[2,2]
seBYG3<-summary(lm(Y~G3))$coefficients[2,2]
BX1G1<-summary(lm(X1~G1))$coefficients[2,1]
BX1G2<-summary(lm(X1~G2))$coefficients[2,1]
BX1G3<-summary(lm(X1~G3))$coefficients[2,1]
seBX1G1<-summary(lm(X1~G1))$coefficients[2,2]
seBX1G2<-summary(lm(X1~G2))$coefficients[2,2]
seBX1G3<-summary(lm(X1~G3))$coefficients[2,2]
BX2G1<-summary(lm(X2~G1))$coefficients[2,1]
BX2G2<-summary(lm(X2~G2))$coefficients[2,1]
BX2G3<-summary(lm(X2~G3))$coefficients[2,1]
seBX2G1<-summary(lm(X2~G1))$coefficients[2,2]
seBX2G2<-summary(lm(X2~G2))$coefficients[2,2]
seBX2G3<-summary(lm(X2~G3))$coefficients[2,2]
BYG1<-summary(lm(Y~G1))$coefficients[2,1]
BYG2<-summary(lm(Y~G2))$coefficients[2,1]
BYG3<-summary(lm(Y~G3))$coefficients[2,1]
seBYG1<-summary(lm(Y~G1))$coefficients[2,2]
seBYG2<-summary(lm(Y~G2))$coefficients[2,2]
seBYG3<-summary(lm(Y~G3))$coefficients[2,2]
BXG_mat<-as.matrix(c(BX1G1,BX1G2,BX1G1))
BXG_mat
BX1G1<-summary(lm(X1~G1))$coefficients[2,1]
BX1G2<-summary(lm(X1~G2))$coefficients[2,1]
BX1G3<-summary(lm(X1~G3))$coefficients[2,1]
BX1G_vec<-c(BX1G1,BX1G2,BX1G3)
seBX1G1<-summary(lm(X1~G1))$coefficients[2,2]
seBX1G2<-summary(lm(X1~G2))$coefficients[2,2]
seBX1G3<-summary(lm(X1~G3))$coefficients[2,2]
BX2G1<-summary(lm(X2~G1))$coefficients[2,1]
BX2G2<-summary(lm(X2~G2))$coefficients[2,1]
BX2G3<-summary(lm(X2~G3))$coefficients[2,1]
BX2G_vec<-c(BX2G1,BX2G2,BX2G3)
seBX2G1<-summary(lm(X2~G1))$coefficients[2,2]
seBX2G2<-summary(lm(X2~G2))$coefficients[2,2]
seBX2G3<-summary(lm(X2~G3))$coefficients[2,2]
BYG1<-summary(lm(Y~G1))$coefficients[2,1]
BYG2<-summary(lm(Y~G2))$coefficients[2,1]
BYG3<-summary(lm(Y~G3))$coefficients[2,1]
seBYG1<-summary(lm(Y~G1))$coefficients[2,2]
seBYG2<-summary(lm(Y~G2))$coefficients[2,2]
seBYG3<-summary(lm(Y~G3))$coefficients[2,2]
BXG_mat<-as.matrix(c(BX1G_vec,BX2G_vec))
BXG_mat
BXG_mat<-as.matrix(c(BX1G_vec,BX2G_vec),3)
BXG_mat
BXG_mat<-as.matrix(c(BX1G_vec,BX2G_vec),nrow=3)
BXG_mat
BXG_mat<-as.data.frame(c(BX1G_vec,BX2G_vec))
BXG_mat
BXG_mat<-as.matrix(BX1G_vec,BX2G_vec)
BXG_mat
BX1G_vec
BX2G_vec
BXG_mat<-as.matrix(BX1G_vec,BX2G_vec,nrow=3)
BXG_mat
BXG_mat<-as.matrix(BX1G_vec,BX2G_vec,nrow=3,ncol=2)
BXG_mat
BXG_mat<-as.matrix(c(BX1G_vec,BX2G_vec),nrow=3,ncol=2)
BXG_mat
BXG_mat<-data.frame(BX1G_vec,BX2G_vec)
BXG_mat
raw_data<-data.frame(BX1G_vec,BX2G_vec,seBX1G_vec,seBX2G_vec,BYG_vec,seBYG_vec)
BX1G1<-summary(lm(X1~G1))$coefficients[2,1]
BX1G2<-summary(lm(X1~G2))$coefficients[2,1]
BX1G3<-summary(lm(X1~G3))$coefficients[2,1]
BX1G_vec<-c(BX1G1,BX1G2,BX1G3)
seBX1G1<-summary(lm(X1~G1))$coefficients[2,2]
seBX1G2<-summary(lm(X1~G2))$coefficients[2,2]
seBX1G3<-summary(lm(X1~G3))$coefficients[2,2]
seBX1G_vec<-c(seBX1G1,seBX1G2,seBX1G3)
BX2G1<-summary(lm(X2~G1))$coefficients[2,1]
BX2G2<-summary(lm(X2~G2))$coefficients[2,1]
BX2G3<-summary(lm(X2~G3))$coefficients[2,1]
BX2G_vec<-c(BX2G1,BX2G2,BX2G3)
seBX2G1<-summary(lm(X2~G1))$coefficients[2,2]
seBX2G2<-summary(lm(X2~G2))$coefficients[2,2]
seBX2G3<-summary(lm(X2~G3))$coefficients[2,2]
seBX2G_vec<-c(seBX2G1,seBX2G2,seBX2G3)
BYG1<-summary(lm(Y~G1))$coefficients[2,1]
BYG2<-summary(lm(Y~G2))$coefficients[2,1]
BYG3<-summary(lm(Y~G3))$coefficients[2,1]
BYG_vec<-c(BYG1,BYG2,BYG3)
seBYG1<-summary(lm(Y~G1))$coefficients[2,2]
seBYG2<-summary(lm(Y~G2))$coefficients[2,2]
seBYG3<-summary(lm(Y~G3))$coefficients[2,2]
seBYG_vec<-c(seBYG1,seBYG2,seBYG3)
raw_data<-data.frame(BX1G_vec,BX2G_vec,seBX1G_vec,seBX2G_vec,BYG_vec,seBYG_vec)
View(raw_data)
raw_data[,c(1,2)]
formatted_data<-format_mvmr(raw_data[,c(1,2)],raw_data[,5],raw_data[,c(3,4)],raw_data[,6])
View(formatted_data)
?ivw_mvmr
mvmr(formatted_data)
library(MVMR)
N<-100000
G1<-rnorm(N,0,1)
G2<-rnorm(N,0,1)
G3<-rnorm(N,0,1)
X1<-1 + 0.5*G1 + 3*G2 + 2*G3 + rnorm(N,0,1)
X2<-1 + 2*G1 + 1.4*G2 + 0.5*G3 + rnorm(N,0,1)
Y<-1 + X1*0.5 + X2*0.7 + rnorm(N,0,1)
BX1G1<-summary(lm(X1~G1))$coefficients[2,1]
BX1G2<-summary(lm(X1~G2))$coefficients[2,1]
BX1G3<-summary(lm(X1~G3))$coefficients[2,1]
BX1G_vec<-c(BX1G1,BX1G2,BX1G3)
seBX1G1<-summary(lm(X1~G1))$coefficients[2,2]
seBX1G2<-summary(lm(X1~G2))$coefficients[2,2]
seBX1G3<-summary(lm(X1~G3))$coefficients[2,2]
seBX1G_vec<-c(seBX1G1,seBX1G2,seBX1G3)
BX2G1<-summary(lm(X2~G1))$coefficients[2,1]
BX2G2<-summary(lm(X2~G2))$coefficients[2,1]
BX2G3<-summary(lm(X2~G3))$coefficients[2,1]
BX2G_vec<-c(BX2G1,BX2G2,BX2G3)
seBX2G1<-summary(lm(X2~G1))$coefficients[2,2]
seBX2G2<-summary(lm(X2~G2))$coefficients[2,2]
seBX2G3<-summary(lm(X2~G3))$coefficients[2,2]
seBX2G_vec<-c(seBX2G1,seBX2G2,seBX2G3)
BYG1<-summary(lm(Y~G1))$coefficients[2,1]
BYG2<-summary(lm(Y~G2))$coefficients[2,1]
BYG3<-summary(lm(Y~G3))$coefficients[2,1]
BYG_vec<-c(BYG1,BYG2,BYG3)
seBYG1<-summary(lm(Y~G1))$coefficients[2,2]
seBYG2<-summary(lm(Y~G2))$coefficients[2,2]
seBYG3<-summary(lm(Y~G3))$coefficients[2,2]
seBYG_vec<-c(seBYG1,seBYG2,seBYG3)
raw_data<-data.frame(BX1G_vec,BX2G_vec,seBX1G_vec,seBX2G_vec,BYG_vec,seBYG_vec)
formatted_data<-format_mvmr(raw_data[,c(1,2)],raw_data[,5],raw_data[,c(3,4)],raw_data[,6])
mvmr(formatted_data)
#library(devtools)
install_github(WSpiller\MVMR)
library(devtools)
install_github(WSpiller/MVMR)
install_github("WSpiller/MVMR")
library(devtools)
install_github("WSpiller/MVMR")
library(MVMR)
N<-100000
G1<-rnorm(N,0,1)
G2<-rnorm(N,0,1)
G3<-rnorm(N,0,1)
X1<-1 + 0.5*G1 + 3*G2 + 2*G3 + rnorm(N,0,1)
X2<-1 + 2*G1 + 1.4*G2 + 0.5*G3 + rnorm(N,0,1)
Y<-1 + X1*0.5 + X2*0.7 + rnorm(N,0,1)
BX1G1<-summary(lm(X1~G1))$coefficients[2,1]
BX1G2<-summary(lm(X1~G2))$coefficients[2,1]
BX1G3<-summary(lm(X1~G3))$coefficients[2,1]
BX1G_vec<-c(BX1G1,BX1G2,BX1G3)
seBX1G1<-summary(lm(X1~G1))$coefficients[2,2]
seBX1G2<-summary(lm(X1~G2))$coefficients[2,2]
seBX1G3<-summary(lm(X1~G3))$coefficients[2,2]
seBX1G_vec<-c(seBX1G1,seBX1G2,seBX1G3)
BX2G1<-summary(lm(X2~G1))$coefficients[2,1]
BX2G2<-summary(lm(X2~G2))$coefficients[2,1]
BX2G3<-summary(lm(X2~G3))$coefficients[2,1]
BX2G_vec<-c(BX2G1,BX2G2,BX2G3)
seBX2G1<-summary(lm(X2~G1))$coefficients[2,2]
seBX2G2<-summary(lm(X2~G2))$coefficients[2,2]
seBX2G3<-summary(lm(X2~G3))$coefficients[2,2]
seBX2G_vec<-c(seBX2G1,seBX2G2,seBX2G3)
BYG1<-summary(lm(Y~G1))$coefficients[2,1]
BYG2<-summary(lm(Y~G2))$coefficients[2,1]
BYG3<-summary(lm(Y~G3))$coefficients[2,1]
BYG_vec<-c(BYG1,BYG2,BYG3)
seBYG1<-summary(lm(Y~G1))$coefficients[2,2]
seBYG2<-summary(lm(Y~G2))$coefficients[2,2]
seBYG3<-summary(lm(Y~G3))$coefficients[2,2]
seBYG_vec<-c(seBYG1,seBYG2,seBYG3)
raw_data<-data.frame(BX1G_vec,BX2G_vec,seBX1G_vec,seBX2G_vec,BYG_vec,seBYG_vec)
formatted_data<-format_mvmr(raw_data[,c(1,2)],raw_data[,5],raw_data[,c(3,4)],raw_data[,6])
mvmr(formatted_data)
install.packages("remotes")
library(remotes)
install_github("WSpiller/MVMR", build_opts = c("--no-resave-data", "--no-manual"), build_vignettes = TRUE)
library(MVMR)
?rawdat_mvmr
vignette("mvmr")
remotes::install_github("WSpiller/MRChallenge2019", build_opts = c("--no-resave-data", "--no-manual"), build_vignettes = TRUE)
remotes::install_github("WSpiller/MVMR", build_opts = c("--no-resave-data", "--no-manual"), build_vignettes = TRUE)
library(MRChallenge2019)
vignette("challenge")
remotes::install_github("WSpiller/MVMR", build_opts = c("--no-resave-data", "--no-manual"), build_vignettes = TRUE)
library(MVMR)
vignette("mvmr")
remotes::install_github("WSpiller/MVMR", build_opts = c("--no-resave-data", "--no-manual"), build_vignettes = TRUE)
library(MVMR)
vignette("mvmr")
install_github("WSpiller/MVMR", build_opts = c("--no-resave-data", "--no-manual"), build_vignettes = TRUE)
library(MVMR)
vignette("mvmr")
install_github("WSpiller/MVMR", build_opts = c("--no-resave-data", "--no-manual"), build_vignettes = TRUE)
library(MVMR)
vignette("MVMR Tutorial")
library(MRPracticals)
vignette("MRBase")
vignette("mrbase")
library(devtools)
install_github(c("MRCIEU/TwoSampleMR","MRCIEU/MRInstruments"))
install_github("WSpiller/MRPracticals",build_opts = c("--no-resave-data", "--no-manual"),build_vignettes = TRUE)
library(MRPracticals)
vignette("RadialMR")
install_github("WSpiller/MRPracticals", build_opts = c("--no-resave-data", "--no-manual"))
install_github("WSpiller/MRPracticals",build_opts = c("--no-resave-data", "--no-manual"),build_vignettes = TRUE,force=T)
library(MRPracticals)
vignette("RadialMR")
vignette("MRBase")
setwd("C:/Users/ws16063/OneDrive - University of Bristol/Desktop/mvmr qhet")
library(MVMR)
library(remotes)
install_github("WSpiller/MVMR", build_opts = c("--no-resave-data", "--no-manual"), build_vignettes = TRUE)
library(MVMR)
?qhet_mvmr
library("devtools")
library(roxygen2)
create("MVMR")
setwd("./MVMR")
document()
